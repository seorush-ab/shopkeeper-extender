"use strict";!function(e,t,r,i,a){var p=a.createElement,s=e.registerBlockType,n=wp.components,o=n.TextControl,g=n.SelectControl,y=(n.RadioControl,n.ToggleControl),l=n.SVG,c=n.Path,_=wp.blockEditor.InspectorControls,h=wp.apiFetch;s("getbowtied/sk-categories-grid",{title:i.__("Product Categories - Grid","shopkeeper-extender"),icon:p(l,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},p(c,{d:"M19 5v2h-4V5h4M9 5v6H5V5h4m10 8v6h-4v-6h4M9 17v2H5v-2h4M21 3h-8v6h8V3zM11 3H3v10h8V3zm10 8h-8v10h8V11zm-10 4H3v6h8v-6z"})),category:"shopkeeper",supports:{align:["center","wide","full"]},attributes:{categoryIDs:{type:"string",default:""},result:{type:"array",default:[]},queryCategories:{type:"string",default:""},queryCategoriesLast:{type:"string",default:""},queryDisplayType:{type:"string",default:"all_categories"},isLoading:{type:"bool",default:!1},querySearchString:{type:"string",default:""},querySearchResults:{type:"array",default:[]},querySearchNoResults:{type:"bool",default:!1},querySearchSelected:{type:"array",default:[]},queryOrder:{type:"string",default:""},parentOnly:{type:"bool",default:!1},hideEmpty:{type:"bool",default:!1},orderby:{type:"string",default:"menu_order"},productCount:{type:"bool",default:!0},firstLoad:{type:"bool",default:!0},limit:{type:"int",default:8},columns:{type:"int",default:3}},edit:function(l){function c(e,t){for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=0;s<t.length;s++)t[s].parent==e&&(t[s].level=a,r.push(t[s]),c(t[s].id,t,r,a+1));return r}function n(e){return"/wc/v3/products/categories"+e}function t(){var e=void 0;e="all_categories"==d.queryDisplayType?u(d.limit,d.orderby,d.parentOnly,d.hideEmpty):d.queryCategories,l.setAttributes({queryCategoriesLast:e}),l.setAttributes({doneFirstPostsLoad:!0}),""!=e&&h({path:e}).then(function(e){"menu_order"==d.orderby&&"all_categories"==d.queryDisplayType&&(e=c(0,e)),l.setAttributes({result:e}),l.setAttributes({isLoading:!1});for(var t="",r=0;r<e.length;r++)t+=e[r].id+",";l.setAttributes({categoryIDs:t})})}function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"menu_order",r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],a=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];if("specific"===d.queryDisplayType)return d.queryCategories;var s=n("?per_page="+e);switch(t){case"menu_order":break;case"title_asc":s+="&orderby=slug&order=asc";break;case"title_desc":s+="&orderby=slug&order=desc"}return!0===r&&(s+="&parent=0"),!0===a&&(s+="&hide_empty=true"),s}var d=l.attributes;return d.selectedIDS=d.selectedIDS||[],d.doneFirstPostsLoad=d.doneFirstPostsLoad||!1,[p(_,{key:"categories-main-inspector"},p("div",{className:"main-inspector-wrapper"},p(g,{key:"query-panel-select",label:i.__("Source:","shopkeeper-extender"),value:d.queryDisplayType,options:[{label:i.__("Manually pick","shopkeeper-extender"),value:"specific"},{label:i.__("All Categories","shopkeeper-extender"),value:"all_categories"}],onChange:function(e){return l.setAttributes({queryDisplayType:e})}}),"specific"===d.queryDisplayType&&p("div",{className:"products-ajax-search-wrapper"},p(o,{key:"query-panel-string",type:"search",className:"products-ajax-search",value:d.querySearchString,placeholder:i.__("Search for categories to display","shopkeeper-extender"),onChange:function(e){if(l.setAttributes({querySearchString:e}),!(e.length<3)){var t=n("?per_page=10&search="+e);h({path:t}).then(function(e){0==e.length?l.setAttributes({querySearchNoResults:!0}):l.setAttributes({querySearchNoResults:!1}),l.setAttributes({querySearchResults:e})})}}})),"specific"===d.queryDisplayType&&""!=d.querySearchString&&p("div",{className:"products-ajax-search-results"},function(){var e=[];if(1==d.querySearchNoResults)return p("span",{className:"no-results"},i.__("No categories matching.","shopkeeper-extender"));for(var t,s=d.querySearchResults,r=0;r<s.length;r++){var a=void 0;a=null!==s[r].image&&""!=s[r].image.src?p("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+s[r].image.src+"')\"></span>"}}):p("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+getbowtied_pbw.woo_placeholder_image+"')\"></span>"}}),e.push(p("span",{key:"item-"+s[r].id,className:(t=s[r].id,-1==d.selectedIDS.indexOf(t)?"single-result":"single-result selected"),title:s[r].name.replace(/&amp;/g,"&"),"data-index":r},a,p("label",{className:"title-wrapper"},p("input",{type:"checkbox",value:r,onChange:function(e){e.target;var t=d.selectedIDS,r=t.indexOf(s[e.target.value].id);-1==r?t.push(s[e.target.value].id):t.splice(r,1),l.setAttributes({selectedIDS:t});var a=n("?include="+t.join(",")+"&orderby=include");0<t.length?l.setAttributes({queryCategories:a}):l.setAttributes({queryCategories:""}),h({path:a}).then(function(e){l.setAttributes({querySearchSelected:e})})}}),s[r].name.replace(/&amp;/g,"&"),p("span",{className:"dashicons dashicons-yes"}),p("span",{className:"dashicons dashicons-no-alt"}))))}return e}()),"specific"===d.queryDisplayType&&0<d.querySearchSelected.length&&p("div",{className:"products-selected-results-wrapper"},p("label",{},i.__("Selected Products:","shopkeeper-extender")),p("div",{className:"products-selected-results"},function(){var e=[],s=d.querySearchSelected;if(d.selectedIDS.length<1&&0<s.length){for(var t=[],r=0;r<s.length;r++)t.push(s[r].id);l.setAttributes({selectedIDS:t})}for(var a=0;a<s.length;a++){var i="";i=null!==s[a].image&&""!=s[a].image.src?p("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+s[a].image.src+"')\"></span>"}}):p("span",{className:"img-wrapper",dangerouslySetInnerHTML:{__html:'<span class="img" style="background-image: url(\''+getbowtied_pbw.woo_placeholder_image+"')\"></span>"}}),e.push(p("span",{key:"item-"+s[a].id,className:"single-result",title:s[a].name.replace(/&amp;/g,"&")},i,p("label",{className:"title-wrapper"},p("input",{type:"checkbox",value:a,onChange:function(e){e.target;var t=d.selectedIDS,r=t.indexOf(s[e.target.value].id);-1!=r&&t.splice(r,1),l.setAttributes({selectedIDS:t});var a=n("?include="+t.join(",")+"&orderby=include");0<t.length?l.setAttributes({queryCategories:a}):l.setAttributes({queryCategories:""}),h({path:a}).then(function(e){l.setAttributes({querySearchSelected:e})})}}),s[a].name.replace(/&amp;/g,"&"),p("span",{className:"dashicons dashicons-no-alt"}))))}return e}())),"all_categories"===d.queryDisplayType&&[p(g,{key:"categories-grid-order-by",options:[{value:"menu_order",label:i.__("Menu Order","shopkeeper-extender")},{value:"title_asc",label:i.__("Alphabetical Ascending","shopkeeper-extender")},{value:"title_desc",label:i.__("Alphabetical Descending","shopkeeper-extender")}],label:i.__("Order By","shopkeeper-extender"),value:d.orderby,onChange:function(e){l.setAttributes({orderby:e})}}),p(o,{key:"categories-grid-display-number",label:i.__("How many product categories to display?","shopkeeper-extender"),type:"number",value:d.limit,onChange:function(e){l.setAttributes({limit:e})}}),p(y,{id:"categories-grid-display",key:"categories-grid-display",label:i.__("Parent Categories Only","shopkeeper-extender"),checked:d.parentOnly,onChange:function(e){l.setAttributes({parentOnly:e})}}),p(y,{key:"categories-grid-hide-empty",label:i.__("Hide Empty","shopkeeper-extender"),checked:d.hideEmpty,onChange:function(e){l.setAttributes({hideEmpty:e})}})],p("button",{className:"render-results components-button is-button is-default is-primary is-large "+(!0===d.isLoading?"is-busy":""),disabled:0==d.queryCategories.length||u(d.limit,d.orderby,d.parentOnly,d.hideEmpty)===d.queryCategoriesLast,onClick:function(e){l.setAttributes({isLoading:!0}),l.setAttributes({querySearchString:""}),l.setAttributes({querySearchResults:[]}),t()}},!1===d.isLoading?i.__("Update","shopkeeper-extender"):i.__("Updating","shopkeeper-extender")),p("hr",{}),p(y,{key:"categories-grid-product-count",label:i.__("Product Count","shopkeeper-extender"),checked:d.productCount,onChange:function(e){l.setAttributes({productCount:e})}}))),p("div",{key:"gbt_18_sk_categories_grid",className:"gbt_18_sk_categories_grid"},"all_categories"==d.queryDisplayType&&!1===d.doneFirstPostsLoad&&t(),function(){if(!0===d.firstLoad){var a=u(d.limit,d.orderby,d.parentOnly,d.hideEmpty);h({path:a}).then(function(e){e=c(0,e),l.setAttributes({result:e}),l.setAttributes({firstLoad:!1}),l.setAttributes({queryCategories:a}),l.setAttributes({queryCategoriesLast:a});for(var t="",r=0;r<e.length;r++)t+=e[r].id+",";l.setAttributes({categoryIDs:t})})}for(var e=d.result,t=[],r=[],s=0,i="",n=0;n<e.length;n++){switch(i="",s++,e.length){case 1:i="one_cat_"+s;break;case 2:i="two_cat_"+s;break;case 3:i="three_cat_"+s;break;case 4:i="four_cat_"+s;break;case 5:i="five_cat_"+s;break;default:i=s<7?s:"more_than_6"}var o="";o=null!==e[n].image?e[n].image.src:"",t.push(p("div",{key:"gbt_18_sk_editor_category_"+i+"_item-"+e[n].id,className:"gbt_18_sk_editor_category_"+i},p("div",{key:"gbt_18_sk_editor_category_grid_box",className:"gbt_18_sk_editor_category_grid_box"},p("span",{key:"gbt_18_sk_editor_category_item_bkg",className:"gbt_18_sk_editor_category_item_bkg",style:{backgroundImage:"url("+o+")"}}),p("a",{key:"gbt_18_sk_editor_category_item",className:"gbt_18_sk_editor_category_item"},p("span",{key:"gbt_18_sk_editor_category_name",className:"gbt_18_sk_category_name"},e[n].name.replace(/&amp;/g,"&"),!0===d.productCount&&p("span",{key:"gbt_18_sk_editor_category_count",className:"gbt_18_sk_category_count"},e[n].count))))))}return r.push(p("div",{key:"gbt_18_sk_editor_categories_grid",className:"gbt_18_sk_editor_categories_grid"},t,p("div",{key:"clearfix",className:"clearfix"}))),r}())]},save:function(){return null}})}(window.wp.blocks,window.wp.components,window.wp.editor,window.wp.i18n,window.wp.element,jQuery);